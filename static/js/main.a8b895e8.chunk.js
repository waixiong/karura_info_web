(this.webpackJsonpkarura_info=this.webpackJsonpkarura_info||[]).push([[0],{494:function(t,e,n){},495:function(t,e,n){},506:function(t,e){},572:function(t,e){},579:function(t,e){},580:function(t,e){},739:function(t,e,n){"use strict";n.r(e);var a,r=n(2),i=n.n(r),c=n(285),s=n.n(c),o=(n(494),n(495),n(788)),l=n(444),u=n(1),d=n(16),h=n.n(d),p=n(193),m=n(26),b=n(35),f=n(119),v=n(3),j=n(6),O=function(){function t(e,n,a){Object(v.a)(this,t),this.id=void 0,this.timestamp=void 0,this.number=void 0,this.id=e||"",this.timestamp=n||0,this.number=a||0}return Object(j.a)(t,null,[{key:"fromJson",value:function(e){return new t(e.id,Date.parse(e.timestamp+"Z"),e.number)}}]),t}(),g=function(){function t(){Object(v.a)(this,t),this.id=void 0,this.blockNumber=void 0,this.block=void 0,this.currency=void 0,this.amount=void 0,this.startAmount=void 0,this.endAmount=void 0,this.id="",this.blockNumber=0,this.currency=[],this.amount=[],this.startAmount=BigInt(0),this.endAmount=BigInt(0)}return Object(j.a)(t,null,[{key:"fromJson",value:function(e){var n,a=new t;if(a.id=e.id,a.blockNumber=e.blockNumber,a.block=O.fromJson(e.block),4===e.data.length){n=JSON.parse(e.data[1].value),a.currency=[];var r,i=Object(b.a)(n);try{for(i.s();!(r=i.n()).done;){var c=r.value;a.currency.push(c.token)}}catch(p){i.e(p)}finally{i.f()}a.startAmount=BigInt(e.data[2].value),a.endAmount=BigInt(e.data[3].value),a.amount=[a.startAmount,a.endAmount]}else{n=JSON.parse(e.data[1].value),a.currency=[];var s,o=Object(b.a)(n);try{for(o.s();!(s=o.n()).done;){c=s.value;a.currency.push(c.token)}}catch(p){o.e(p)}finally{o.f()}a.amount=[];var l,u=JSON.parse(e.data[2].value),d=Object(b.a)(u);try{for(d.s();!(l=d.n()).done;){var h=l.value;a.amount.push(h)}}catch(p){d.e(p)}finally{d.f()}a.startAmount=a.amount[0],a.endAmount=a.amount[a.amount.length-1]}return a}}]),t}(),y=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(v.a)(this,t),this.pair=void 0,this.rawSwaps=void 0,this.volumeNative=0,this.volumeUSD=0,this.liquidityNative=0,this.liquidityUSD=0,this.date=void 0,this.lastBlockNumber=void 0,this.pair=e,this.rawSwaps=n,this.date="",this.lastBlockNumber=0}return Object(j.a)(t,[{key:"token0",get:function(){return this.pair.split("-")[0]}},{key:"token1",get:function(){return this.pair.split("-")[1]}}]),t}(),x=function t(e){Object(v.a)(this,t),this.id=void 0,this.blockNumber=void 0,this.block=void 0,this.fromCurrency=void 0,this.fromAmount=void 0,this.toCurrency=void 0,this.toAmount=void 0,this.id=e.id,this.blockNumber=e.blockNumber,this.block=e.block,this.fromAmount=e.fromAmount,this.fromCurrency=e.fromCurrency,this.toAmount=e.toAmount,this.toCurrency=e.toCurrency},k=function t(e,n,a){Object(v.a)(this,t),this.pair=void 0,this.data24h=void 0,this.dataByDays=void 0,this.pair=e,this.data24h=n,this.dataByDays=a},w="KSM",N={KAR:{KSM:"KAR-KSM"},KUSD:{KSM:"KUSD-KSM"},KSM:{KAR:"KAR-KSM",KUSD:"KUSD-KSM"}},S="https://api.polkawallet.io/acala-subql";function C(t,e){return T.apply(this,arguments)}function T(){return(T=Object(m.a)(h.a.mark((function t(e,n){var r,i,c,s,o,l;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.request)(S,Object(f.gql)(a||(a=Object(p.a)(['\n            query {\n                events (\n                    orderBy: BLOCK_NUMBER_DESC\n                    filter: {\n                        method: { equalTo: "Swap" }\n                        blockNumber: { \n                            greaterThan: "','"\n                            ',"\n                        }\n                    }\n                ) {\n                    nodes {\n                        id\n                        method\n                        data\n                        blockNumber\n                        block {\n                            id\n                            timestamp\n                            number\n                        }\n                    }\n                }\n            }\n        "])),e,void 0!==n?'lessThanOrEqualTo: "'.concat(n,'"'):""));case 2:r=t.sent,i=r.events.nodes,c=[],s=Object(b.a)(i);try{for(s.s();!(o=s.n()).done;)l=o.value,c.push(g.fromJson(l))}catch(u){s.e(u)}finally{s.f()}return t.abrupt("return",c);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var D,A=n(13);n(789),n(785),n(431),n(438);function B(t){return t.setUTCHours(0),t.setUTCMinutes(0),t.setUTCSeconds(0),t.setUTCMilliseconds(0),t}function M(t){return t.setUTCHours(23),t.setUTCMinutes(59),t.setUTCSeconds(59),t.setUTCMilliseconds(999),t}function K(t){if(0===t.length)return[];var e=E(function(t){var e=new Date;e.setHours(e.getHours()-24);for(var n=0,a=0;a<t.length&&(n=a,!(t[a].block.timestamp<e.getTime()));a++);return t.slice(0,n)}(t));e.forEach((function(t,e){J(t)}));var n,a=q(t),r=new Map,i=Object(b.a)(a);try{for(i.s();!(n=i.n()).done;){E(n.value).forEach((function(t,e){var n;r.has(e)||r.set(e,[]),J(t),null===(n=r.get(e))||void 0===n||n.push(t)}))}}catch(s){i.e(s)}finally{i.f()}var c=[];return e.forEach((function(t,e){var n;c.push(new k(e,t,null!==(n=r.get(e))&&void 0!==n?n:[]))})),c}function U(t){var e,n=[],a=0,r=Object(b.a)(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.currency.length>2&&2===i.amount.length)a++;else for(var c=0;c<i.currency.length-1;c++){var s=new x({id:i.id,block:i.block,blockNumber:i.blockNumber,fromCurrency:i.currency[c],toCurrency:i.currency[c+1],fromAmount:i.amount[c],toAmount:i.amount[c+1]});n.push(s)}}}catch(o){r.e(o)}finally{r.f()}return[n,a]}function q(t){for(var e=[[]],n=M(new Date(t[t.length-1].block.timestamp)).getTime();t.length>0;){var a=t.pop();a.block.timestamp>n&&(e.push([]),n=M(new Date(a.block.timestamp)).getTime()),e[e.length-1].push(a)}return e}function E(t){var e,n=new Map,a=Object(b.a)(t);try{for(a.s();!(e=a.n()).done;){var r=e.value,i=N[r.fromCurrency][r.toCurrency];n.has(i)||n.set(i,new y(i)),n.get(i).rawSwaps.push(r)}}catch(c){a.e(c)}finally{a.f()}return n.forEach((function(e,n){e.date=B(new Date(t[0].block.timestamp)).toUTCString(),e.lastBlockNumber=t[0].blockNumber})),n}function J(t){var e,n=Object(b.a)(t.rawSwaps);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(t.token0===w||t.token1===w)if(a.fromCurrency===w){var r=Number(a.fromAmount)/1e12;t.volumeNative+=r}else{r=Number(a.toAmount)/1e12/.997;t.volumeNative+=r}}}catch(i){n.e(i)}finally{n.f()}}function L(){return R.apply(this,arguments)}function R(){return(R=Object(m.a)(h.a.mark((function t(){var e,n,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.request)(S,Object(f.gql)(D||(D=Object(p.a)(["\n            query {\n                blocks (\n                    orderBy: NUMBER_DESC\n                    first: 1\n                ) {\n                    nodes {\n                        id\n                        number\n                        timestamp\n                    }\n                }\n            }\n        "]))));case 2:return e=t.sent,n=e.blocks.nodes,a=n[0],t.abrupt("return",O.fromJson(a));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var F=n(790);function I(){return(I=Object(m.a)(h.a.mark((function t(e,n,a){var r,i,c,s,o,l;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.lastBlock,t.next=3,C(r,e);case 3:i=t.sent,c=U(i),s=Object(u.a)(c,2),o=s[0],s[1],console.log("\t\tupdate: ".concat(n.lastBlock," -> ").concat(e)),o.push.apply(o,Object(A.a)(n.swap)),console.log("\t\tswap count: ".concat(o.length)),l=K(Object(A.a)(o)),a({lastBlock:e,swap:o,data:l,loaded7d:n.loaded7d});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var V=function(t,e){!function(t,e){H.apply(this,arguments)}(t,e)};function H(){return(H=Object(m.a)(h.a.mark((function t(e,n){var a,r,i,c,s,o,l,d;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={lastBlock:e},(r=new Date).setHours(r.getHours()-24),i=e-7300,t.next=6,C(i);case 6:c=t.sent,s=U(c),o=Object(u.a)(s,2),l=o[0],o[1],d=l[l.length-1].blockNumber-1,a.swap=l,console.log("\t\t24h swap count: ".concat(l.length)),a.data=K(Object(A.a)(l)),a.loaded7d=!1,n(a),_(d,a,n);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _(t,e,n){return P.apply(this,arguments)}function P(){return(P=Object(m.a)(h.a.mark((function t(e,n,a){var r,i,c,s,o,l,d,p,m;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=B(new Date)).setUTCDate(i.getUTCDate()-6),c=(new Date).getTime()-i.getTime(),s=e-(c/12e3+300),t.next=6,C(s,e);case 6:o=t.sent,l=o.length-1;case 8:if(!(l>=0)){t.next=17;break}if(!(o[l].block.timestamp<i.getTime())){t.next=13;break}o.pop(),t.next=14;break;case 13:return t.abrupt("break",17);case 14:l--,t.next=8;break;case 17:d=U(o),p=Object(u.a)(d,2),m=p[0],p[1],(r=n.swap).push.apply(r,Object(A.a)(m)),n.data=K(Object(A.a)(n.swap)),n.loaded7d=!0,console.log("\t\t7d swap count: ".concat(n.swap.length)),a(n);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Y=n(776),z=n(446),G=n.n(z),Z=n(793),Q=n(747),W=n(777),X=n(786),$=n(792),tt=n(202),et=n(464),nt=n(462),at=Object(nt.a)({palette:{type:"dark",primary:{light:"#e40c5b",main:"#f53347",dark:"#f53347",contrastText:"#fff"},secondary:{light:"#ff7961",main:"#f44336",dark:"#ba000d",contrastText:"#000"}}}),rt=n(27),it=Object(r.createContext)({state:{},dispatch:{}}),ct=function(t){var e=t.children,n=t.value,a=void 0===n?{}:n,i=Object(r.useState)(a),c=Object(u.a)(i,2),s=c[0],o=c[1];return Object(rt.jsx)(it.Provider,{value:{state:s,dispatch:o},children:e})},st=function(){var t=Object(r.useContext)(it);if(!t)throw new Error("useDexState must be used within a DexStateContext");return t},ot=Object(Y.a)((function(t){return{displayContent:{display:"flex",flexDirection:"column","& > *":{margin:t.spacing(1),width:t.spacing(80),height:t.spacing(32)}},paperCard:{"& > *":{margin:t.spacing(1)}},syncTitle:{"& > *":{margin:t.spacing(0)}},smallTitle:{fontSize:12},smallValue:{fontSize:20}}}));function lt(){var t=ot(),e=Object(F.a)("lastBlock",Object(m.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",L());case 1:case"end":return t.stop()}}),t)}))),{cacheTime:6e4,staleTime:3e4}),n=e.isLoading,a=e.error,r=e.data,i=st(),c=i.state,s=i.dispatch;return n||null!==a||(void 0===c.lastBlock?V(r.number,s):c.lastBlock!==r.number&&function(t,e,n){I.apply(this,arguments)}(r.number,c,s)),n?"Loading...":a?"An error has occurred: "+a.message:Object(rt.jsxs)("div",{className:t.syncTitle,children:[Object(rt.jsxs)("p",{children:["Sync At Block ",Object(rt.jsx)("strong",{children:r.number})]}),Object(rt.jsx)("p",{className:t.smallTitle,children:new Date(r.timestamp).toUTCString()})]})}function ut(){var t=ot(),e=st().state;return void 0===e.swap?"Loading...":e.swap.length<=0?"No Data":Object(rt.jsxs)("div",{children:[e.loaded7d?Object(rt.jsx)("div",{}):Object(rt.jsx)("div",{children:"Loading 7 days data..."}),Object(rt.jsx)(Z.a,{className:t.displayContent,children:e.data.map((function(t,e){return console.log("\tPool: ".concat(t.pair)),Object(rt.jsx)(dt,{pool:t},t.pair)}))})]})}function dt(t){var e=t.pool,n=ot(),a=Object(r.useState)(void 0),i=Object(u.a)(a,2),c=i[0],s=i[1],o=Object(r.useState)(void 0),l=Object(u.a)(o,2),d=l[0],h=l[1];return Object(rt.jsx)(Q.a,{elevation:0,children:Object(rt.jsxs)(W.a,{container:!0,spacing:3,children:[Object(rt.jsxs)(W.a,{item:!0,xs:4,children:[Object(rt.jsx)(X.a,{p:1,pt:1,children:e.pair}),Object(rt.jsx)(X.a,{pl:1,pt:1,className:n.smallTitle,children:"TVL"}),Object(rt.jsx)(X.a,{pl:1,pb:1,className:n.smallValue,children:"not ready"}),Object(rt.jsx)(X.a,{pl:1,pt:1,className:n.smallTitle,children:"24h Volume"}),Object(rt.jsxs)(X.a,{pl:1,pb:1,className:n.smallValue,children:[e.data24h.volumeNative.toFixed(3)," KSM"]}),Object(rt.jsx)(X.a,{pl:1,pt:1,className:n.smallTitle,children:"24h Fees"}),Object(rt.jsxs)(X.a,{pl:1,pb:1,className:n.smallValue,children:[(.003*e.data24h.volumeNative).toFixed(3)," KSM"]}),Object(rt.jsx)(X.a,{pl:1,pt:1,className:n.smallTitle,children:d}),Object(rt.jsx)(X.a,{pl:1,pb:1,className:n.smallValue,children:c})]}),Object(rt.jsx)(W.a,{item:!0,xs:8,children:Object(rt.jsxs)($.a,{width:444,height:256,data:e.dataByDays,margin:{top:5,right:30,left:20,bottom:5},onMouseLeave:function(){s(void 0),h(void 0)},children:[Object(rt.jsx)(tt.a,{cursor:{fill:at.palette.secondary.dark},contentStyle:{display:"none"},formatter:function(t,e,n){s(n.payload.volumeNative.toFixed(3)+" KSM"),h(G()(n.payload.date).format("MMM D, YYYY"))}}),Object(rt.jsx)(et.a,{dataKey:"volumeNative",fill:at.palette.primary.main})]})})]})})}var ht=n(781),pt=n(782),mt=n(783),bt=n(784),ft=new o.a,vt=Object(Y.a)((function(t){return{appBar:{flexGrow:1,position:"fixed"},menuButton:{marginRight:t.spacing(2)},title:{flexGrow:1},topRight:{alignContent:"right"},displayContent:{display:"flex",flexDirection:"column","& > *":{margin:t.spacing(1),width:t.spacing(80),height:t.spacing(32)}},display:{"& > *":{margin:t.spacing(1)}}}}));var jt=function(){return Object(rt.jsx)(ht.a,{theme:at,children:Object(rt.jsx)(l.a,{client:ft,children:Object(rt.jsx)("div",{className:"App-background",children:Object(rt.jsxs)(ct,{children:[Object(rt.jsx)(Ot,{}),Object(rt.jsx)("div",{className:"App",children:Object(rt.jsx)(ut,{})})]})})})})};function Ot(){var t=vt();return Object(rt.jsx)(pt.a,{className:t.appBar,children:Object(rt.jsxs)(mt.a,{children:[Object(rt.jsx)(bt.a,{variant:"h6",className:t.title,children:"Karura Info"}),Object(rt.jsx)(bt.a,{variant:"h6",className:t.topRight,children:Object(rt.jsx)(lt,{})})]})})}var gt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,794)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),a(t),r(t),i(t),c(t)}))};s.a.render(Object(rt.jsx)(i.a.StrictMode,{children:Object(rt.jsx)(jt,{})}),document.getElementById("root")),gt()}},[[739,1,2]]]);
//# sourceMappingURL=main.a8b895e8.chunk.js.map